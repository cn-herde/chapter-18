---
title: "Learning dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)

```

```{r load data, echo=FALSE}

# read in data set

learning_data <- read_csv2("fake_learning_data.csv",
                           col_names = c("employee",
                                         "organization",
                                         "training",
                                         "training_type",
                                         "learning_hours"),
                           skip = 1)
# worked well
```





Column {data-width=650}
-----------------------------------------------------------------------

### Chart A

```{r}

# create a chart that shows total training hours by company
## need to aggregate to company 

by_organization <- group_by(learning_data,
                       organization)

# get total training hours by organization, then arrange by number
table_total_training_hours_by_organization <- summarise(by_organization,
                                                   total = sum(learning_hours,
                                                               na.rm = TRUE)) %>%
  arrange(desc(total))

## create horizontal bar plot

plot_1 <- ggplot(table_total_training_hours_by_organization,
                 aes(x = reorder(organization, total),
                     y = total)) +
  geom_col() +
  coord_flip()

plot_2 <- plot_1 +
    labs(x = "Organization", 
       y = "Total learning hours")

plot_2

# further improvements:
## put values into bars
## color the bars
## remove axis scales
## remove gray background
## put y-axis at top instead of bottom
## Put title to the very top left




```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}

```

### Chart C

```{r}

```

